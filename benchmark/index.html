<!doctype html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒÚ©Ø§ÙˆÛŒ EFQM 2025</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body { font-family: Vazirmatn, Tahoma; background:#f6f8fb; padding:20px; color:#222; }
h1, h2 { color:#004aad; }
.card { background:#fff; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.08); padding:18px; margin-bottom:20px; }
button { background:#004aad; color:white; border:none; padding:10px 16px; border-radius:8px; cursor:pointer; }
button:hover { background:#003b8e; }
.chart-container { width:100%; max-width:900px; margin:auto; }
table { width:100%; border-collapse:collapse; margin-top:10px; font-size:14px; }
th, td { border:1px solid #e1e5eb; padding:8px; text-align:center; }
th { background:#e9f0ff; }
footer { text-align:center; margin-top:25px; color:#777; font-size:13px; }
header { display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; }
header img { height:60px; }
</style>
</head>
<body>

<header>
  <div>
    <h1>ğŸ“Š Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒÚ©Ø§ÙˆÛŒ EFQM 2025</h1>
    <p>Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø³Ø§Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§ Ø¯Ø± Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ù…Ø¯Ù„ ØªØ¹Ø§Ù„ÛŒ</p>
  </div>
  <img src="https://github.com/hamideghtedarian/hamideghtedarian-hamideghtedarian/blob/main/logo.png?raw=true" alt="Ù„ÙˆÚ¯Ùˆ">
</header>

<div class="card">
  <h2>ğŸ“ Ø§Ù†ØªØ®Ø§Ø¨ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø²Ù…Ø§Ù†â€ŒÙ‡Ø§</h2>
  <input type="file" id="multiInput" multiple accept=".json">
  <p class="small">ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø®Ø±ÙˆØ¬ÛŒ ÙØ±Ù… Ø§Ø±Ø²ÛŒØ§Ø¨ÛŒ (criteria) Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¯Ù‡ Ø¨Ø§Ø´Ù†Ø¯.</p>
</div>

<div class="card">
  <h2>ğŸ“ˆ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ (Ù†Ù…ÙˆØ¯Ø§Ø± Ù…ÛŒÙ„Ù‡â€ŒØ§ÛŒ Ú¯Ø±ÙˆÙ‡ÛŒ)</h2>
  <div class="chart-container"><canvas id="barChart"></canvas></div>
</div>

<div class="card">
  <h2>ğŸ•¸ï¸ Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø±Ø§Ø¯Ø§Ø±ÛŒ EFQM 2025</h2>
  <div class="chart-container"><canvas id="radarChart"></canvas></div>
</div>

<div class="card">
  <h2>ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡â€ŒØ§ÛŒ Ø§Ù…ØªÛŒØ§Ø²Ø§Øª</h2>
  <div id="tableWrap">ÙØ§ÛŒÙ„ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</div>
</div>

<div style="text-align:center;">
  <button onclick="window.print()">ğŸ–¨ï¸ Ú†Ø§Ù¾ / Ø°Ø®ÛŒØ±Ù‡ PDF</button>
</div>

<footer>
  <img src="https://github.com/hamideghtedarian/hamideghtedarian-hamideghtedarian/blob/main/banner.png?raw=true" style="max-width:250px;"><br>
  <p>Â© 2025 Hamid Eghtedarian â€” EFQM 2025 Benchmarking Dashboard</p>
</footer>

<script>
let barChart, radarChart;

document.getElementById('multiInput').addEventListener('change', async e=>{
  const files=e.target.files;
  if(!files.length) return;
  const datasets=[], orgNames=[], allCriteria=new Set();

  for(const f of files){
    const text=await f.text();
    const json=JSON.parse(text);
    const org=json.metadata.organization||f.name.replace('.json','');
    orgNames.push(org);
    const data=json.criteria.map(c=>({id:c.criterion_id,score:c.average_score||0}));
    data.forEach(d=>allCriteria.add(d.id));
    datasets.push({org,data});
  }

  const criteria=Array.from(allCriteria).sort((a,b)=>a-b);
  renderCharts(criteria,datasets);
  renderTable(criteria,datasets);
});

/* ======= Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ ======= */
function renderCharts(criteria,datasets){
  const labels=criteria.map(c=>'Ù…Ø¹ÛŒØ§Ø± '+c);
  const colors=['#004aad','#00b894','#e17055','#6c5ce7','#fdcb6e','#0984e3','#d63031'];
  const barData=datasets.map((d,i)=>({
    label:d.org,
    data:criteria.map(cid=>d.data.find(x=>x.id===cid)?.score||0),
    backgroundColor:colors[i%colors.length]+'99'
  }));

  const ctx1=document.getElementById('barChart').getContext('2d');
  if(barChart) barChart.destroy();
  barChart=new Chart(ctx1,{
    type:'bar',
    data:{labels,datasets:barData},
    options:{
      responsive:true,
      scales:{y:{beginAtZero:true,max:100}},
      plugins:{legend:{position:'bottom'}}
    }
  });

  const radarData=datasets.map((d,i)=>({
    label:d.org,
    data:criteria.map(cid=>d.data.find(x=>x.id===cid)?.score||0),
    backgroundColor:colors[i%colors.length]+'33',
    borderColor:colors[i%colors.length],
    pointBackgroundColor:colors[i%colors.length]
  }));

  const ctx2=document.getElementById('radarChart').getContext('2d');
  if(radarChart) radarChart.destroy();
  radarChart=new Chart(ctx2,{
    type:'radar',
    data:{labels,datasets:radarData},
    options:{
      responsive:true,
      scales:{r:{min:0,max:100,ticks:{stepSize:20}}},
      plugins:{legend:{position:'bottom'}}
    }
  });
}

/* ======= Ø¬Ø¯ÙˆÙ„ ======= */
function renderTable(criteria,datasets){
  let html='<table><tr><th>Ù…Ø¹ÛŒØ§Ø±</th>';
  datasets.forEach(d=>html+=`<th>${d.org}</th>`);
  html+='</tr>';
  criteria.forEach(cid=>{
    html+=`<tr><td>${cid}</td>`;
    datasets.forEach(d=>{
      const val=d.data.find(x=>x.id===cid)?.score||'-';
      html+=`<td>${val.toFixed?val.toFixed(1):'-'}</td>`;
    });
    html+='</tr>';
  });
  html+='</table>';
  document.getElementById('tableWrap').innerHTML=html;
}
</script>
</body>
</html>
